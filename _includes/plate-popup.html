<!-- ============================= -->
<!-- FOOD & FERTILITY PLATE POPUP  -->
<!-- ============================= -->

<style>
  /* Keep popup button styling scoped to popup only */
  #ff-popup-overlay .custom-btn {
    display: inline-block !important;
    padding: 12px 30px !important;
    border-radius: 9999px !important; /* pill */
    background-color: #1d4939 !important; /* green */
    color: #ffffff !important;           /* keep text white */
    text-decoration: none !important;
    border: none !important;
    font-family: 'Montserrat', sans-serif !important;
    font-size: 16px !important;
    font-weight: 600 !important;
    line-height: 1.1 !important;
    transition: all 0.3s ease !important;
    -webkit-appearance: none;
    appearance: none;
  }

  #ff-popup-overlay .custom-btn:hover,
  #ff-popup-overlay .custom-btn:active,
  #ff-popup-overlay .custom-btn:focus,
  #ff-popup-overlay .custom-btn:focus-visible {
    background-color: #f7980f !important; /* orange */
    color: #ffffff !important;
    outline: none !important;
  }

  /* Prevent visited link color change */
  #ff-popup-overlay .custom-btn:visited {
    color: #ffffff !important;
  }

  /* Mobile stack */
  @media (max-width: 640px) {
    #ff-popup {
      flex-direction: column !important;
      align-items: flex-start !important;
    }
    #ff-popup-actions {
      width: 100%;
    }
    #ff-popup-overlay .custom-btn {
      width: 100% !important;
      text-align: center !important;
    }
  }
</style>

<div
  id="ff-popup-overlay"
  style="
    position: fixed;
    left: 16px;
    right: 16px;
    bottom: 16px;
    z-index: 9999;
    display: none;
    justify-content: center;
  "
>
  <div
    id="ff-popup"
    style="
      position: relative;
      max-width: 900px;
      width: 100%;
      background: #ffffff;
      border-radius: 18px;
      border: 1px solid rgba(29, 73, 57, 0.12);
      box-shadow: 0 14px 40px rgba(0, 0, 0, 0.14);
      padding: 20px 22px;
      display: flex;
      justify-content: space-between;
      gap: 20px;
      align-items: center;
      font-family: 'Montserrat', sans-serif;
    "
  >
    <!-- Close button -->
    <button
      type="button"
      id="ff-popup-close"
      style="
        position: absolute;
        top: 10px;
        right: 12px;
        background: none;
        border: none;
        font-size: 22px;
        cursor: pointer;
        line-height: 1;
        color: #1d4939;
        font-family: 'Montserrat', sans-serif;
      "
      aria-label="Close popup"
    >
      ×
    </button>

    <!-- Text -->
    <div style="display:flex;flex-direction:column;gap:6px;padding-right:10px;">
      <h2
        style="
          margin: 0;
          font-size: 1.25rem;
          font-weight: 700;
          color: #1d4939;
          font-family: 'Montserrat', sans-serif;
        "
      >
        Download The Fertility Plate — free
      </h2>

      <div
        style="
          font-size: 0.95rem;
          color: #333;
          font-family: 'Montserrat', sans-serif;
        "
      >
        A simple guide to building meals that support fertility.
      </div>
    </div>

    <!-- CTA -->
    <div
      id="ff-popup-actions"
      style="display:flex;align-items:center;gap:10px;flex-shrink:0;"
    >
      <a
  id="ff-popup-download"
  href="/The%20Fertility%20Plate.pdf"
  class="custom-btn"
  download
>
  Download
</a>
    </div>
  </div>
</div>

<script>
  (function () {
    const SHOW_DELAY_MS = 8000;
    const HIDE_AFTER_CLOSE_DAYS = 7;
    const HIDE_AFTER_DOWNLOAD_DAYS = 30;

    const KEY_HIDE_UNTIL = "ff_popup_hide_until_ts";

    function now() {
      return Date.now();
    }
    function daysToMs(d) {
      return d * 24 * 60 * 60 * 1000;
    }
    function shouldShow() {
      const until = parseInt(localStorage.getItem(KEY_HIDE_UNTIL) || "0", 10);
      return now() > until;
    }
    function setHide(days) {
      localStorage.setItem(KEY_HIDE_UNTIL, String(now() + daysToMs(days)));
    }

    if (shouldShow()) {
      setTimeout(function () {
        const popup = document.getElementById("ff-popup-overlay");
        if (popup) popup.style.display = "flex";
      }, SHOW_DELAY_MS);
    }

    const closeBtn = document.getElementById("ff-popup-close");
    if (closeBtn) {
      closeBtn.addEventListener("click", function () {
        const overlay = document.getElementById("ff-popup-overlay");
        if (overlay) overlay.style.display = "none";
        setHide(HIDE_AFTER_CLOSE_DAYS);
      });
    }

    const downloadBtn = document.getElementById("ff-popup-download");
    if (downloadBtn) {
      downloadBtn.addEventListener("click", function () {
        const overlay = document.getElementById("ff-popup-overlay");
        if (overlay) overlay.style.display = "none";
        setHide(HIDE_AFTER_DOWNLOAD_DAYS);
      });
    }
  })();
</script>
